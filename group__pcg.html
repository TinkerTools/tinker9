<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tinker9: PCG</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tinker9<span id="projectnumber">&#160;75dcc9c (Thu Jan 19 17:30:12 2023 -0600)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">PCG</div></div>
</div><!--header-->
<div class="contents">

<p>Preconditioned Conjugate Gradient.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa29a57baa5772513b927285f070395ec"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#gaa29a57baa5772513b927285f070395ec">tinker::pcgUdirV1</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#acb20b6ca0acf533a4a0d6c68d83c61e4">polarity</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#a7b0b66905ed5ccfaf5d6ae72cdab1dd6">udir</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*field)[3])</td></tr>
<tr class="memdesc:gaa29a57baa5772513b927285f070395ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the direct induced dipoles <code>2b</code>.  <a href="group__pcg.html#gaa29a57baa5772513b927285f070395ec">More...</a><br /></td></tr>
<tr class="separator:gaa29a57baa5772513b927285f070395ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1880f1c23506b04beaa82ab58c5bbc4b"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#ga1880f1c23506b04beaa82ab58c5bbc4b">tinker::pcgUdirV2</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#acb20b6ca0acf533a4a0d6c68d83c61e4">polarity</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#a7b0b66905ed5ccfaf5d6ae72cdab1dd6">udir</a>)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#abec89fcc2df78de017b27f55adfc5ffc">udirp</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*field)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*fieldp)[3])</td></tr>
<tr class="memdesc:ga1880f1c23506b04beaa82ab58c5bbc4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the direct induced dipoles <code>2b</code>.  <a href="group__pcg.html#ga1880f1c23506b04beaa82ab58c5bbc4b">More...</a><br /></td></tr>
<tr class="separator:ga1880f1c23506b04beaa82ab58c5bbc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa71c94c57653a10815016c0c72758793"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#gaa71c94c57653a10815016c0c72758793">tinker::pcgRsd0V1</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#a1b4b52dcb09d4610bed557a751e7a9f2">polarity_inv</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsd)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#a7b0b66905ed5ccfaf5d6ae72cdab1dd6">udir</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#ac628ee371acc8e01ae668e782dfa58e9">uind</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*field)[3])</td></tr>
<tr class="memdesc:gaa71c94c57653a10815016c0c72758793"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the initial residuals for the predictor <code>3a</code>.  <a href="group__pcg.html#gaa71c94c57653a10815016c0c72758793">More...</a><br /></td></tr>
<tr class="separator:gaa71c94c57653a10815016c0c72758793"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga45361e8dba3d0784d92a6117c22b06e5"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#ga45361e8dba3d0784d92a6117c22b06e5">tinker::pcgRsd0V2</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#a1b4b52dcb09d4610bed557a751e7a9f2">polarity_inv</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsd)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsp)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#a7b0b66905ed5ccfaf5d6ae72cdab1dd6">udir</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*udip)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#ac628ee371acc8e01ae668e782dfa58e9">uind</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#aebfb61c1fedcb098fab0dbcdd3f9c3a1">uinp</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*field)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*fielp)[3])</td></tr>
<tr class="memdesc:ga45361e8dba3d0784d92a6117c22b06e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the initial residuals for the predictor <code>3a</code>.  <a href="group__pcg.html#ga45361e8dba3d0784d92a6117c22b06e5">More...</a><br /></td></tr>
<tr class="separator:ga45361e8dba3d0784d92a6117c22b06e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa9ad1fdcff46553f38c3440706a0a93f"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#gaa9ad1fdcff46553f38c3440706a0a93f">tinker::pcgRsd0V3</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#a1b4b52dcb09d4610bed557a751e7a9f2">polarity_inv</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsd)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#a7b0b66905ed5ccfaf5d6ae72cdab1dd6">udir</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#ac628ee371acc8e01ae668e782dfa58e9">uind</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*field)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#ace39268efbde19c536a5807dd8594c47">polscale</a>)[3][3])</td></tr>
<tr class="memdesc:gaa9ad1fdcff46553f38c3440706a0a93f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the initial residuals for the predictor <code>3a</code> using the <a href="https://doi.org/10.1021/acs.jpcb.2c04237">Exchange-Polarization Model.</a>  <a href="group__pcg.html#gaa9ad1fdcff46553f38c3440706a0a93f">More...</a><br /></td></tr>
<tr class="separator:gaa9ad1fdcff46553f38c3440706a0a93f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf98ac9c0f11f1bd3390907ffc1ef0600"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#gaf98ac9c0f11f1bd3390907ffc1ef0600">tinker::pcgRsd0</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#acb20b6ca0acf533a4a0d6c68d83c61e4">polarity</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsd)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsdp)[3])</td></tr>
<tr class="memdesc:gaf98ac9c0f11f1bd3390907ffc1ef0600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the residual to zero for atoms with zero polarizability.  <a href="group__pcg.html#gaf98ac9c0f11f1bd3390907ffc1ef0600">More...</a><br /></td></tr>
<tr class="separator:gaf98ac9c0f11f1bd3390907ffc1ef0600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e51071a5ff733f2a7a4152e1302f287"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#ga6e51071a5ff733f2a7a4152e1302f287">tinker::pcgRsd1</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#acb20b6ca0acf533a4a0d6c68d83c61e4">polarity</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsd)[3])</td></tr>
<tr class="memdesc:ga6e51071a5ff733f2a7a4152e1302f287"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the residual to zero for atoms with zero polarizability.  <a href="group__pcg.html#ga6e51071a5ff733f2a7a4152e1302f287">More...</a><br /></td></tr>
<tr class="separator:ga6e51071a5ff733f2a7a4152e1302f287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7e9fcb64ebe5bbc426e4a467c599d369"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#ga7e9fcb64ebe5bbc426e4a467c599d369">tinker::pcgP1</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#a1b4b52dcb09d4610bed557a751e7a9f2">polarity_inv</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*vec)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*vecp)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*conj)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*conjp)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*field)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*fieldp)[3])</td></tr>
<tr class="memdesc:ga7e9fcb64ebe5bbc426e4a467c599d369"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the vector Ap &ndash; step <code>5a</code>.  <a href="group__pcg.html#ga7e9fcb64ebe5bbc426e4a467c599d369">More...</a><br /></td></tr>
<tr class="separator:ga7e9fcb64ebe5bbc426e4a467c599d369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga820151ba67bc11f9815b118ad06c0309"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#ga820151ba67bc11f9815b118ad06c0309">tinker::pcgP2</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#acb20b6ca0acf533a4a0d6c68d83c61e4">polarity</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ka, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *kap, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ksum, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ksump, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#ac628ee371acc8e01ae668e782dfa58e9">uind</a>)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#aebfb61c1fedcb098fab0dbcdd3f9c3a1">uinp</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*conj)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*conjp)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsd)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsdp)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*vec)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*vecp)[3])</td></tr>
<tr class="memdesc:ga820151ba67bc11f9815b118ad06c0309"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the induced dipoles and residuals &ndash; step <code>5bc</code>.  <a href="group__pcg.html#ga820151ba67bc11f9815b118ad06c0309">More...</a><br /></td></tr>
<tr class="separator:ga820151ba67bc11f9815b118ad06c0309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9bab24602c3a5edba217fa32d720eed4"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#ga9bab24602c3a5edba217fa32d720eed4">tinker::pcgP3</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ksum, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ksump, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ksum1, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ksump1, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*conj)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*conjp)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*zrsd)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*zrsdp)[3])</td></tr>
<tr class="memdesc:ga9bab24602c3a5edba217fa32d720eed4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the scalar b from s0 and s, then updates the vector p &ndash; <code>5ef</code>.  <a href="group__pcg.html#ga9bab24602c3a5edba217fa32d720eed4">More...</a><br /></td></tr>
<tr class="separator:ga9bab24602c3a5edba217fa32d720eed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b80970f035831fd567a07b6d3c9dd12"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#ga6b80970f035831fd567a07b6d3c9dd12">tinker::pcgP4</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#a1b4b52dcb09d4610bed557a751e7a9f2">polarity_inv</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*vec)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*conj)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*field)[3])</td></tr>
<tr class="memdesc:ga6b80970f035831fd567a07b6d3c9dd12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the vector Ap &ndash; step <code>5a</code>.  <a href="group__pcg.html#ga6b80970f035831fd567a07b6d3c9dd12">More...</a><br /></td></tr>
<tr class="separator:ga6b80970f035831fd567a07b6d3c9dd12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga411d04fb768641cc95bb059dec72c2db"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#ga411d04fb768641cc95bb059dec72c2db">tinker::pcgP5</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#acb20b6ca0acf533a4a0d6c68d83c61e4">polarity</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ka, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ksum, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#ac628ee371acc8e01ae668e782dfa58e9">uind</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*conj)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsd)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*vec)[3])</td></tr>
<tr class="memdesc:ga411d04fb768641cc95bb059dec72c2db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the induced dipoles and residuals &ndash; step <code>5bc</code>.  <a href="group__pcg.html#ga411d04fb768641cc95bb059dec72c2db">More...</a><br /></td></tr>
<tr class="separator:ga411d04fb768641cc95bb059dec72c2db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaade5c9a44197956d62327b1a5e424418"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#gaade5c9a44197956d62327b1a5e424418">tinker::pcgP6</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ksum, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *ksum1, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*conj)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*zrsd)[3])</td></tr>
<tr class="memdesc:gaade5c9a44197956d62327b1a5e424418"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the scalar b from s0 and s, then updates the vector p &ndash; <code>5ef</code>.  <a href="group__pcg.html#gaade5c9a44197956d62327b1a5e424418">More...</a><br /></td></tr>
<tr class="separator:gaade5c9a44197956d62327b1a5e424418"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab6e3f9b3443046d62fdb9463b45afd73"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#gab6e3f9b3443046d62fdb9463b45afd73">tinker::pcgPeek</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, float pcgpeek, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#acb20b6ca0acf533a4a0d6c68d83c61e4">polarity</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#ac628ee371acc8e01ae668e782dfa58e9">uind</a>)[3], <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#aebfb61c1fedcb098fab0dbcdd3f9c3a1">uinp</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsd)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsdp)[3])</td></tr>
<tr class="memdesc:gab6e3f9b3443046d62fdb9463b45afd73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the peek step.  <a href="group__pcg.html#gab6e3f9b3443046d62fdb9463b45afd73">More...</a><br /></td></tr>
<tr class="separator:gab6e3f9b3443046d62fdb9463b45afd73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga32107fddac0c2e1f705a73f4ef486762"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pcg.html#ga32107fddac0c2e1f705a73f4ef486762">tinker::pcgPeek1</a> (int <a class="el" href="group__ff.html#gad2e089162a2f11d8850f715592d9acdb">n</a>, float pcgpeek, const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *<a class="el" href="namespacetinker.html#acb20b6ca0acf533a4a0d6c68d83c61e4">polarity</a>, <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*<a class="el" href="namespacetinker.html#ac628ee371acc8e01ae668e782dfa58e9">uind</a>)[3], const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*rsd)[3])</td></tr>
<tr class="memdesc:ga32107fddac0c2e1f705a73f4ef486762"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the peek step.  <a href="group__pcg.html#ga32107fddac0c2e1f705a73f4ef486762">More...</a><br /></td></tr>
<tr class="separator:ga32107fddac0c2e1f705a73f4ef486762"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Preconditioned Conjugate Gradient. </p>


<h3><a id="pcg" name="pcg"></a>The PCG method in Tinker9 is implemented as follows</h3><div class="textblock"><ol type="1">
<li>Goal: To solve Au = E, where A = 1/a + T.<ul>
<li>(a) E: external field;</li>
<li>(b) a: polarizability;</li>
<li>(c) -Tu: mutual induced field; i.e., <code>ufield(u)</code>.</li>
</ul>
</li>
<li>Guess initial induced dipole: u.<ul>
<li>(a) Predict: u = <code>fromPrediction</code> </li>
<li>(b) Direct guess: u = aE</li>
<li>(c) Zero: u = 0</li>
</ul>
</li>
<li>Compute initial residual: r = E - Au<ul>
<li>(a) Predict: r = (aE-u)/a + <code>ufield(u)</code> </li>
<li>(b) Direct guess: r = <code>ufield(aE)</code> </li>
<li>(c) Zero: r = E</li>
</ul>
</li>
<li>p = Mr; s0 = rMr<ul>
<li>M is the preconditioner which approximates A.</li>
</ul>
</li>
<li>While not converged (r is still big):<ul>
<li>(a) g = s0 / pAp, where Ap = p/a - <code>ufield(p)</code> </li>
<li>(b) u = u + gp</li>
<li>(c) r = r - gAp</li>
<li>(d) s = rMr</li>
<li>(e) b = s / s0</li>
<li>(f) p = Mr + bp; s0 = s</li>
</ul>
</li>
<li>Peek: u = u + peek*a*r &ndash; optional, empirical. </li>
</ol>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ga7e9fcb64ebe5bbc426e4a467c599d369" name="ga7e9fcb64ebe5bbc426e4a467c599d369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7e9fcb64ebe5bbc426e4a467c599d369">&#9670;&#160;</a></span>pcgP1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgP1 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity_inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>vec</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>vecp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>conj</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>conjp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>field</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>fieldp</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the vector Ap &ndash; step <code>5a</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity_inv</td><td>Multiplicative inverse of polarizabilities.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vec</td><td>d-vector Ap.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vecp</td><td>p-vector Ap.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">conj</td><td>d-vector p.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">conjp</td><td>p-vector p.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">field</td><td>d-<code>ufield(p)</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fieldp</td><td>p-<code>ufield(p)</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga820151ba67bc11f9815b118ad06c0309" name="ga820151ba67bc11f9815b118ad06c0309"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga820151ba67bc11f9815b118ad06c0309">&#9670;&#160;</a></span>pcgP2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgP2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ka</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>kap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ksum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ksump</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uind</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uinp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>conj</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>conjp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsd</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsdp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>vec</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>vecp</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the induced dipoles and residuals &ndash; step <code>5bc</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity</td><td>Polarizabilities.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ka</td><td>Device pointer to the dot product d-pAp.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kap</td><td>Device pointer to the dot product p-pAp.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ksum</td><td>Device pointer to the dot product d-s0.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ksump</td><td>Device pointer to the dot product p-s0.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uind</td><td>d-dipoles.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uinp</td><td>p-dipoles.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">conj</td><td>d-vector p.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">conjp</td><td>p-vector p.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rsd</td><td>d-residuals.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rsdp</td><td>p-residuals.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vec</td><td>d-vector Ap.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vecp</td><td>p-vector Ap. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9bab24602c3a5edba217fa32d720eed4" name="ga9bab24602c3a5edba217fa32d720eed4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9bab24602c3a5edba217fa32d720eed4">&#9670;&#160;</a></span>pcgP3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgP3 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ksum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ksump</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ksum1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ksump1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>conj</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>conjp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>zrsd</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>zrsdp</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the scalar b from s0 and s, then updates the vector p &ndash; <code>5ef</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ksum</td><td>Device pointer to the d-scalar s0.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ksump</td><td>Device pointer to the p-scalar s0.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ksum1</td><td>Device pointer to the d-scalar s.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ksump1</td><td>Device pointer to the p-scalar s.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">conj</td><td>d-vector p.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">conjp</td><td>p-vector p.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">zrsd</td><td>d-vector Mr.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">zrsdp</td><td>p-vector Mr. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga6b80970f035831fd567a07b6d3c9dd12" name="ga6b80970f035831fd567a07b6d3c9dd12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6b80970f035831fd567a07b6d3c9dd12">&#9670;&#160;</a></span>pcgP4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgP4 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity_inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>vec</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>conj</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>field</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the vector Ap &ndash; step <code>5a</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity_inv</td><td>Multiplicative inverse of polarizabilities.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vec</td><td>Vector Ap.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">conj</td><td>Vector p.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">field</td><td><code>ufield(p)</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga411d04fb768641cc95bb059dec72c2db" name="ga411d04fb768641cc95bb059dec72c2db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga411d04fb768641cc95bb059dec72c2db">&#9670;&#160;</a></span>pcgP5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgP5 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ka</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ksum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uind</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>conj</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsd</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>vec</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the induced dipoles and residuals &ndash; step <code>5bc</code>. </p>
<p >Vector Ap. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity</td><td>Polarizabilities.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ka</td><td>Device pointer to the dot product pAp.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ksum</td><td>Device pointer to the dot product s0.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uind</td><td>Induced dipoles.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">conj</td><td>Vector p.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rsd</td><td>Residuals. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaade5c9a44197956d62327b1a5e424418" name="gaade5c9a44197956d62327b1a5e424418"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaade5c9a44197956d62327b1a5e424418">&#9670;&#160;</a></span>pcgP6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgP6 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ksum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>ksum1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>conj</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>zrsd</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the scalar b from s0 and s, then updates the vector p &ndash; <code>5ef</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ksum</td><td>Deivce pointer to the scalar s0.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ksum1</td><td>Device pointer to the scalar s.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">conj</td><td>Vector p.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">zrsd</td><td>Vector Mr. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab6e3f9b3443046d62fdb9463b45afd73" name="gab6e3f9b3443046d62fdb9463b45afd73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab6e3f9b3443046d62fdb9463b45afd73">&#9670;&#160;</a></span>pcgPeek()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgPeek </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcgpeek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uind</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uinp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsd</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsdp</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the peek step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pcgpeek</td><td>The "peek" parameter.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity</td><td>Polarizabilities.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uind</td><td>d-dipoles.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uinp</td><td>p-dipoles.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rsd</td><td>Final d-residual.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rsdp</td><td>Final p-residual. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga32107fddac0c2e1f705a73f4ef486762" name="ga32107fddac0c2e1f705a73f4ef486762"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga32107fddac0c2e1f705a73f4ef486762">&#9670;&#160;</a></span>pcgPeek1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgPeek1 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcgpeek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uind</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsd</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the peek step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pcgpeek</td><td>The "peek" parameter.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity</td><td>Polarizabilities.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uind</td><td>Dipoles.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rsd</td><td>Final residual. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf98ac9c0f11f1bd3390907ffc1ef0600" name="gaf98ac9c0f11f1bd3390907ffc1ef0600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf98ac9c0f11f1bd3390907ffc1ef0600">&#9670;&#160;</a></span>pcgRsd0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgRsd0 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsd</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsdp</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the residual to zero for atoms with zero polarizability. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity</td><td>polarizabilities.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rsd</td><td>Zero d-residuals.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rsdp</td><td>Zero p-residuals. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa71c94c57653a10815016c0c72758793" name="gaa71c94c57653a10815016c0c72758793"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa71c94c57653a10815016c0c72758793">&#9670;&#160;</a></span>pcgRsd0V1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgRsd0V1 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity_inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsd</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>udir</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uind</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>field</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the initial residuals for the predictor <code>3a</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity_inv</td><td>Multiplicative inverse of polarizabilities.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rsd</td><td>Initial residuals.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">udir</td><td>Direct induced dipoles <code>2b</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">uind</td><td>Initial induced dipoles <code>2a</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">field</td><td>Mutual field. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga45361e8dba3d0784d92a6117c22b06e5" name="ga45361e8dba3d0784d92a6117c22b06e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga45361e8dba3d0784d92a6117c22b06e5">&#9670;&#160;</a></span>pcgRsd0V2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgRsd0V2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity_inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsd</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>udir</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>udip</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uind</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uinp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>field</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>fielp</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the initial residuals for the predictor <code>3a</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity_inv</td><td>Multiplicative inverse of polarizabilities.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rsd</td><td>Initial d-residuals.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rsp</td><td>Initial p-residuals.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">udir</td><td>Direct induced d-dipoles <code>2b</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">udip</td><td>Direct induced p-dipoles <code>2b</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">uind</td><td>Initial induced d-dipoles <code>2a</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">uinp</td><td>Initial induced p-dipoles <code>2a</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">field</td><td>Mutual d-field.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fielp</td><td>Mutual p-field. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa9ad1fdcff46553f38c3440706a0a93f" name="gaa9ad1fdcff46553f38c3440706a0a93f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa9ad1fdcff46553f38c3440706a0a93f">&#9670;&#160;</a></span>pcgRsd0V3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgRsd0V3 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity_inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsd</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>udir</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>uind</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>field</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>polscale</em>[3][3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the initial residuals for the predictor <code>3a</code> using the <a href="https://doi.org/10.1021/acs.jpcb.2c04237">Exchange-Polarization Model.</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity_inv</td><td>Multiplicative inverse of polarizabilities.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rsd</td><td>Initial residuals.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">udir</td><td>Direct induced dipoles <code>2b</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">uind</td><td>Initial induced dipoles <code>2a</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">field</td><td>Mutual field.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polscale</td><td>The \( I+kS^2 \) matrices for every atom (Eq. (7d)). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga6e51071a5ff733f2a7a4152e1302f287" name="ga6e51071a5ff733f2a7a4152e1302f287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6e51071a5ff733f2a7a4152e1302f287">&#9670;&#160;</a></span>pcgRsd1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgRsd1 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>rsd</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the residual to zero for atoms with zero polarizability. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity</td><td>polarizabilities.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rsd</td><td>Zero residuals. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa29a57baa5772513b927285f070395ec" name="gaa29a57baa5772513b927285f070395ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa29a57baa5772513b927285f070395ec">&#9670;&#160;</a></span>pcgUdirV1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgUdirV1 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>udir</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>field</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the direct induced dipoles <code>2b</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity</td><td>Polarizabilities.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">udir</td><td>Direct induced dipoles <code>2b</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">field</td><td>External field. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1880f1c23506b04beaa82ab58c5bbc4b" name="ga1880f1c23506b04beaa82ab58c5bbc4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1880f1c23506b04beaa82ab58c5bbc4b">&#9670;&#160;</a></span>pcgUdirV2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void tinker::pcgUdirV2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a> *&#160;</td>
          <td class="paramname"><em>polarity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>udir</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>udirp</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>field</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__prec.html#ga705b733820a8480aac42d7dcb3bbd7e0">real</a>(*)&#160;</td>
          <td class="paramname"><em>fieldp</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the direct induced dipoles <code>2b</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of atoms.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">polarity</td><td>Polarizabilities.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">udir</td><td>Direct induced d-dipoles <code>2b</code>.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">udirp</td><td>Direct induced p-dipoles <code>2b</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">field</td><td>External d-field.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fieldp</td><td>External p-field. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
